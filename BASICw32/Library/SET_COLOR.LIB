!
EXTERNAL SUB SET_POINT_COLOR(s$)
DECLARE EXTERNAL FUNCTION COLOR_INDEX_OF
SET POINT COLOR COLOR_INDEX_OF(s$)
END SUB
!
EXTERNAL SUB SET_LINE_COLOR(s$)
DECLARE EXTERNAL FUNCTION COLOR_INDEX_OF
SET LINE COLOR COLOR_INDEX_OF(s$)
END SUB
!
EXTERNAL SUB SET_AREA_COLOR(s$)
DECLARE EXTERNAL FUNCTION COLOR_INDEX_OF
SET AREA COLOR COLOR_INDEX_OF(s$)
END SUB
!
EXTERNAL SUB SET_TEXT_COLOR(s$)
DECLARE EXTERNAL FUNCTION COLOR_INDEX_OF
SET TEXT COLOR COLOR_INDEX_OF(s$)
END SUB
!
EXTERNAL FUNCTION COLOR_INDEX_OF(s$)
DECLARE NUMERIC n,i,r,b,g
LET s$=UCASE$(s$)
ASK MAX COLOR n
SELECT CASE s$
CASE "WHITE","îí"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=1 AND g=1 AND b=1 THEN EXIT FOR
   NEXT i
CASE "BLACK","çï"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=0 AND g=0 AND b=0 THEN EXIT FOR
   NEXT i
CASE "BLUE","ê¬"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=0 AND g=0 AND b=1 THEN EXIT FOR
   NEXT i
CASE "GREEN","óŒ"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=0 AND g=1 AND b=0 THEN EXIT FOR
   NEXT i
CASE "RED","ê‘"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=1 AND g=0 AND b=0 THEN EXIT FOR
   NEXT i
CASE "CYAN"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=0 AND g=1 AND b=1 THEN EXIT FOR
   NEXT i
CASE "MAGENTA"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=1 AND g=0 AND b=1 THEN EXIT FOR
   NEXT i
CASE "YELLOW","â©"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=1 AND g=1 AND b=0 THEN EXIT FOR
   NEXT i
CASE "GRAY"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=g AND g=b AND 0<r AND r<0.6 THEN EXIT FOR
   NEXT i
CASE "SILVER"
   FOR i=0 TO n
      ASK COLOR MIX(i) r,g,b
      IF r=g AND g=b AND 0.6<=r AND r<1 THEN EXIT FOR
   NEXT i
CASE ELSE
   CAUSE EXCEPTION 11085
END SELECT
IF i<=n THEN
   LET COLOR_INDEX_OF=i
ELSE 
   CAUSE EXCEPTION 11085
END IF 
END FUNCTION








