EXTERNAL SUB sort(a())
CALL q_sort(a,LBOUND(a),UBOUND(a))
END SUB
EXTERNAL SUB q_sort(a(),l,r)
IF r<=l THEN
   EXIT SUB
ELSE 
   LET i=l-1
   LET j=r
   LET pv=a(r)
   DO
      DO 
         LET i=i+1
      LOOP UNTIL pv<=a(i)
      DO 
         LET j=j-1
      LOOP UNTIL j<=i OR a(j)<=pv
      IF j<=i THEN EXIT DO
      LET t=a(i)
      LET a(i)=a(j)
      LET a(j)=t
   LOOP
   LET t=a(i)
   LET a(i)=a(r)
   LET a(r)=t
   CALL q_sort(a,l,i-1) 
   CALL q_sort(a,i+1,r)
END IF 
END SUB

