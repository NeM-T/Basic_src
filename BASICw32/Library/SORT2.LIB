! ixにはmと下限，上限を一致させた空の配列を指定する。
! mは参照されるのみ。
! ixにmの添字を大きさの順に並べて返す。
! つまり，m(ix(1))≦m(ix(2))≦m(ix(3))≦･･･となる。

EXTERNAL SUB sort(m(),ix())
FOR i=LBOUND(m) TO UBOUND(m)
   LET ix(i)=i
NEXT i
CALL q_sort(m,ix,LBOUND(m),UBOUND(m))
END SUB

EXTERNAL SUB q_sort(m(),a(),l,r)
IF r<=l THEN
   EXIT SUB
ELSE 
   LET i=l-1
   LET j=r
   LET pv=m(a(r))
   DO
      DO 
         LET i=i+1
      LOOP UNTIL pv<=m(a(i))
      DO 
         LET j=j-1
      LOOP UNTIL j<=i OR m(a(j))<=pv
      IF j<=i THEN EXIT DO
      LET t=a(i)
      LET a(i)=a(j)
      LET a(j)=t
   LOOP
   LET t=a(i)
   LET a(i)=a(r)
   LET a(r)=t
   CALL q_sort(m,a,l,i-1) 
   CALL q_sort(m,a,i+1,r)
END IF 
END SUB

