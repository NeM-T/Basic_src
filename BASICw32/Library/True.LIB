! JIS Full BASICにないTrue BASIC組込関数
! 次行に示すDECLARE文を関数を利用するプログラム単位の初めに書いてください。
! DECLARE EXTERNAL FUNCTION CPOS,CPOSR,NCPOS,NCPOSR,POSR

EXTERNAL FUNCTION CPOS(a$,b$)
REM a$中にb$中のいずれかの文字が最初に現れる位置
REM 存在しなければ0
REM 例　CPOS("APPLE JUICE","SET")=5
FOR i=1 TO LEN(a$)
   IF POS(b$,a$(i:i))>0 THEN
      LET CPOS=i
      EXIT FUNCTION
   END IF
NEXT i
LET CPOS=0
END FUNCTION

EXTERNAL FUNCTION CPOSR(a$,b$)
REM a$中にb$中のいずれかの文字が最後に現れる位置
REM 存在しなければ0
REM 例 CPOSR("APPLE JUICE","SET")=11
FOR i=LEN(a$) TO 1 STEP -1
   IF POS(b$,a$(i:i))>0 THEN
      LET CPOSR=i
      EXIT FUNCTION
   END IF
NEXT i
LET CPOSR=0
END FUNCTION

EXTERNAL FUNCTION NCPOS(a$,b$)
REM a$中にb$中にない文字が最初に現れる位置
REM すべてあるときは0
REM 例 NCPOS("APPLE JUICE","SET")=1 
FOR i=1 TO LEN(a$)
   IF POS(b$,a$(i:i))=0 THEN
      LET NCPOS=i
      EXIT FUNCTION
   END IF
NEXT i
LET NCPOS=0
END FUNCTION

EXTERNAL FUNCTION NCPOSR(a$,b$)
REM a$中にb$中にない文字が最後に現れる位置
REM すべてあるときは0
REM 例 NCPOSR("APPLE JUICE","SET")=10
FOR i=LEN(a$) TO 1 STEP -1
   IF POS(b$,a$(i:i))=0 THEN
      LET NCPOSR=i
      EXIT FUNCTION
   END IF
NEXT i
LET NCPOSR=0
END FUNCTION

EXTERNAL FUNCTION POSR(a$,b$)
REM a$中にb$が最後に現れる位置
REM 存在しないときは0
LET n=LEN(b$)-1
FOR i=LEN(a$)-n TO 1 STEP -1
   IF a$(i:i+n)=b$ THEN
      LET POSR=i
      EXIT FUNCTION
   END IF
NEXT i
LET POSR=0
END FUNCTION

